{% extends "errors/base_error.html" %}

{% block error_title %}Too Many Requests - KreasiPOS Enterprise{% endblock %}

{% block error_content %}
<div class="error-icon text-warning">
    <i class="bi bi-hourglass-split"></i>
</div>

<h1 class="error-code">429</h1>
<h2 class="h3 mb-4">Too Many Requests</h2>

<p class="text-muted mb-4">
    You've made too many requests in a short period of time. 
    Please wait a moment before trying again.
</p>

<div class="progress mb-4" style="height: 6px;">
    <div class="progress-bar progress-bar-striped progress-bar-animated" 
         role="progressbar" style="width: 100%"></div>
</div>

<div class="error-actions">
    <button onclick="location.reload()" class="btn btn-primary me-3" id="retry-btn" disabled>
        <i class="bi bi-arrow-clockwise"></i> 
        <span id="countdown">30</span> seconds
    </button>
    <a href="{{ url_for('sales.pos') }}" class="btn btn-outline-secondary">
        <i class="bi bi-house"></i> Go Home
    </a>
</div>

<div class="mt-4">
    <small class="text-muted">
        This is an automatic rate limiting protection. Normal access will resume shortly.
    </small>
</div>

<script>
    // Countdown timer for retry button
    let seconds = 30;
    const countdownElement = document.getElementById('countdown');
    const retryButton = document.getElementById('retry-btn');
    
    const countdown = setInterval(() => {
        seconds--;
        countdownElement.textContent = seconds;
        
        if (seconds <= 0) {
            clearInterval(countdown);
            retryButton.disabled = false;
            retryButton.innerHTML = '<i class="bi bi-arrow-clockwise"></i> Try Again';
        }
    }, 1000);
</script>
{% endblock %}